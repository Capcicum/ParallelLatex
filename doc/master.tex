\documentclass[12px,oz]{report}

\usepackage [english]{babel}
\usepackage [autostyle, english = american]{csquotes}
\MakeOuterQuote{"} % allow usage of "x" instead of ``x''

\usepackage{placeins}
\usepackage{xr-hyper} % must be before hyperref
\usepackage[hidelinks]{hyperref}
\usepackage{graphicx}
\usepackage{pdflscape}
%\usepackage{oz} % conflicts with siunitx
\usepackage{float}
\usepackage{titlesec}
\titleformat{\chapter}[hang] % remove "Chapter N" before chapter name
{\Huge\bfseries}{\thechapter.\hspace{20pt}}{0pt}{\Huge\bfseries}
\titlespacing*{\chapter}{0pt}{10pt}{5pt}


\usepackage[margin=1in]{geometry} % margin!
\usepackage{listings}
\usepackage[dvipsnames]{xcolor}

% for SI units
\usepackage[binary-units=true, detect-all]{siunitx}	

\usepackage{amsmath} % \text{}

\usepackage{longtable}

\usepackage[skip=4pt]{caption} % make captions closer to picture


\usepackage{setspace}
%\singlespacing
\onehalfspacing

\setcounter{secnumdepth}{3} % set subsubsections to be numbered as well

% when using the english language, autoref to subsection and section simply writes "section" instead of using the prefix
\addto\extrasenglish{
	\let\subsectionautorefname\sectionautorefname
	\let\subsubsectionautorefname\sectionautorefname
}

% Header and footer
\usepackage{lastpage}
\usepackage{fancyhdr}
\cfoot{\thepage\ of \pageref{LastPage}}

% Subfigure
\usepackage{caption}
\usepackage{subcaption}

% remove new page after chapter
\usepackage{etoolbox}
\makeatletter
\patchcmd{\chapter}{\if@openright\cleardoublepage\else\clearpage\fi}{}{}{}
\makeatother


\usepackage{listings}
\usepackage{tcolorbox}

\newcommand{\lstfont}[1]{\color{#1}\scriptsize\ttfamily}

\lstset{
	language=[ANSI]C++,
	captionpos=b,
	showstringspaces=false,
	backgroundcolor=\color{black!90},
	basicstyle=\lstfont{white},
	identifierstyle=\lstfont{white},
	keywordstyle=\lstfont{magenta!40},
	numberstyle=\lstfont{white},
	stringstyle=\lstfont{cyan},
	commentstyle=\lstfont{yellow!30},
	emph={
		cudaMalloc, cudaFree, cudaMemcpy,
		__global__, __shared__, __device__, __host__, __constant__,
		__syncthreads, dim3,
		cudaMemcpyDeviceToHost, cudaMemcpyHostToDevice, cudaMemcpyDeviceToDevice,
	},
	emphstyle={\lstfont{green!60!white}},
	breaklines=true
}

% custom functions
\newenvironment{enumerateSmall}%
{%\vspace{-5mm}
	\begin{enumerate}%
		\setlength{\itemsep}{0pt}%
		\setlength{\parskip}{0pt}}%
	{\end{enumerate}}

\newenvironment{itemizeSmall}%
{%\vspace{-5mm}
	\begin{itemize}%
		\setlength{\itemsep}{0pt}%
		\setlength{\parskip}{0pt}}%
	{\end{itemize}}

% DEFINES!
\def \cuda {CUDA}

\begin{document}	
\pagenumbering{roman} % "gobble" can be used if no pagenumbering is needed	
% TITLE PAGE
	\begin{titlepage}
		\centering
		\vspace*{3\baselineskip}
		{\Huge \bfseries Parallel Programming}
		\rule{\linewidth}{0.5mm}
		%\vspace*{1\baselineskip}\\
		\LARGE
		Reading Course
		\\
		\null\vfill
		\begin{flushleft} \large
			au503241 \hspace*{2em} \  Frederik Andersen\\
			au500070 \hspace*{2em} \  Mathias Jessen\\
			au501580 \hspace*{2em} \  Michael Ilkiv Misbih\\
			au501465 \hspace*{2em} \  Morten Morberg Madsen\\
			au505313 \hspace*{2em} \  Thomas Holm Nielsen\\
			\vspace{100pt}
			Supervisor:\hspace{94pt}  Date: \\
			Kim Bjerge \hspace{90pt}  \today\\
		\end{flushleft}
		\vspace*{6\baselineskip}
	\end{titlepage}

\tableofcontents
\clearpage
\pagenumbering{arabic}
\cleardoublepage

\chapter{Programming Model}
\label{ch-programming-model}
\input{content/programming-model-intro.tex}
% mapping: Programming to Hardware

	\section{Kernels}
	\label{sec-pm-kernels}
	\input{content/pm-kernels.tex}

	\section{Threads}
	\label{sec-pm-threads}
	\input{content/pm-threads.tex}
	
	\section{Memory}
	\label{sec-pm-memory}
	\input{content/pm-memory.tex}
	
	\section{Synchronization}
	\label{sec-pm-synch}
	\input{content/pm-synch.tex}
	
	\section{Streams}
	\label{sec-pm-streams}
	\input{content/pm-streams.tex}	
	
	\section{Dynamic Parallelism}
	\label{sec-pm-dynamic}
	\input{content/pm-dynamic.tex}
	
	\section{Intrinsics}
	\label{sec-pm-intrinsics}
	\input{content/intrinsics.tex}


\chapter{Parallel Communication Patterns}
\label{ch-patterns}
\input{content/patterns.tex}
	
	\section{Map}
	\label{sec-map}
	\input{content/map.tex}
	
	\section{Gather}
	\label{sec-gather}
	\input{content/gather.tex}
	
	\section{Scatter}
	\label{sec-scatter}
	\input{content/scatter.tex}
	
	\section{Stencil}
	\label{sec-stencil}
	\input{content/stencil.tex}
	
	\section{Transpose}
	\label{sec-transpose}
	\input{content/transpose.tex}
	
\chapter{Algorithms}
\label{ch:algorithms}
\input{content/algorithms.tex}

	\section{Reduction}
	\label{sec:al_reduction}
	\input{content/reduction.tex}
	
	\section{Scan}
	\label{sec:al_scan}
	\input{content/scan.tex}
	
		\subsection{Hillis/Steele Scan}
		\label{sec:al_scan_hillis_steele}
		\input{content/hillis_steele.tex}
		
		\subsection{Blelloch Scan}
		\label{sec:al_scan_blelloch}
		\input{content/blelloch.tex}
	
	\section{Histogram}
	\label{sec:al_histogram}
	\input{content/histogram.tex}
	
	\section{Sort}
	\label{sec:al_sort}
	\input{content/sort.tex}
	
		\subsection{Radix Sort}
		\label{sec:al_sort_radix}
		\input{content/radix.tex}

	\section{Compact}
	\label{sec-compact}
	\input{content/compact.tex}
	
	\section{Allocate}
	\label{sec-allocate}
	\input{content/allocate.tex}

\chapter{Applications}
\label{ch-app}

	\section{Graph}
	\label{sec-graph}
	\input{content/graph.tex}
	
	\section{Matrix}
	\label{sec-matrix}
	\input{content/matrix.tex}
	
	\section{Exercises}
	
		\subsection{Exercise 1}
		
		\subsection{Exercise 2}
		
		\subsection{Exercise 3}
		\input{content/exercise3.tex}
		
		\subsection{Exercise 4}
		\input{content/exercise4.tex}
		
		\subsection{Exercise 5}
		
		\subsection{Exercise 6}
	
\chapter{CUDA libraries}
\label{ch-libraries}
\input{content/libraries.tex}

	\section{Thrust}
	\label{sec-thrust}
	\input{content/thrust.tex}
	
	\section{OpenCL}
	\label{sec-opencl}
	\input{content/opencl.tex}

% citation test
\cite{McCool2012}
\cite{udacity:parallel}

\bibliographystyle{plain}
\bibliography{bib}

\appendix
\chapter{test}

\end{document}
